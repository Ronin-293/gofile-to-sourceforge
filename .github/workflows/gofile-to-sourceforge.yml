- name: Download ROM (preserve original filename)
        run: |
          echo "Downloading from Gofile..."
          curl -LJO "${{ github.event.inputs.gofile_url }}"

          echo "Files in workspace:"
          ls -lh

          FILE_NAME=$(ls *.zip | head -n 1)
          if [ -z "$FILE_NAME" ]; then
            echo "ERROR: No ZIP file downloaded!"
            exit 1
          fi

          echo "Detected file: $FILE_NAME"
          echo "FILE_NAME=$FILE_NAME" >> $GITHUB_ENV

      - name: Upload to SourceForge (safe path + auto folder)
        run: |
          echo "Uploading $FILE_NAME to SourceForge folder: ${{ github.event.inputs.sf_folder }}"

          sshpass -p "${{ secrets.SF_PASSWORD }}" sftp -o StrictHostKeyChecking=no \
          ${{ secrets.SF_USER }}@frs.sourceforge.net <<EOF
          cd /home/frs/project/Munch\ roms
          mkdir ${{ github.event.inputs.sf_folder }}
          cd ${{ github.event.inputs.sf_folder }}
          put "$FILE_NAME"
          bye
          EOF